<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>The Big Five Aspects Scale results &mdash; ejelome</title>
        <meta name="description"
            content="The Big Five Aspects Scale results" />
        <link rel="stylesheet" 
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" />
        <link rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css" />
        <style>
            body {
                font: 1rem/150% sans-serif;
                font-size: 75%;
                padding: 1rem;
            }
            h1 {
                font-size: medium;
                position: absolute;
                left: 33%;
                top: 1rem;
            }
            .tab-content {
                position: relative;
                padding: 1rem 0;
            }
            .nav-item.nav-link.active {
                font-weight: bold;
            }
            .filters {
                position: absolute;
                right: 0;   
                top: 1rem;
            }
            .dropdown-menu {
                min-width: 100%;
            }
            .dropdown .btn,
            .dropdown .dropdown-item {
                font-size: x-small;
            }
            .dropdown .btn {
                border-color: #CED4DA;
            }
            .dropdown.filter-show {
                margin-right: 0.5rem;
            }
            .wrapper {
                width: 80%;
            }
            #polar-chart {
                position: relative;
                right: 0.5rem;
            }
        </style>
    </head>
    <body>
        <h1>
            <a href="https://github.com/ejelome">@ejelome</a>'s
            <em>The Big Five Aspects Scale</em> results
        </h1>
        <nav>
            <div class="nav nav-tabs" 
                id="nav-tab" 
                role="tablist">
                <a class="nav-item nav-link" 
                    id="nav-table-tab" 
                    data-toggle="tab" 
                    href="index.html" 
                    role="tab" 
                    aria-controls="nav-table" 
                    aria-selected="false">Table</a>
                <a class="nav-item nav-link active"
                    id="nav-chart-tab"
                    data-toggle="tab"
                    href="chart.html" 
                    role="tab" 
                    aria-controls="nav-chart"
                    aria-selected="true">Chart</a>
            </div>
        </nav>
        <div class="tab-content"
            id="nav-tabContent">
            <div class="filters form-inline">
                <div class="dropdown filter-show">
                    <button class="btn btn-sm btn-light dropdown-toggle" 
                        type="button" 
                        id="dropdownMenuButton" 
                        data-toggle="dropdown" 
                        aria-haspopup="true" 
                        aria-expanded="false">Show</button>
                    <div class="dropdown-menu" 
                        aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item show-all" 
                            href="#">Show All</a>
                        <a class="dropdown-item show-traits"
                            href="#">Show Traits Only</a>
                        <a class="dropdown-item show-aspects"
                            href="#">Show Aspects Only</a>
                    </div>
                </div>
                <div class="dropdown dropdown-menu-right filter-sort">
                    <button class="btn btn-sm btn-light dropdown-toggle" 
                        type="button" 
                        id="dropdownMenuButton" 
                        data-toggle="dropdown" 
                        aria-haspopup="true" 
                        aria-expanded="false">Sort</button>
                    <div class="dropdown-menu dropdown-menu-right" 
                        aria-labelledby="dropdownMenuButton">
                        <a class="dropdown-item sort-id" 
                            href="#">Sort By ID</a>
                        <a class="dropdown-item sort-name" 
                            href="#">Sort By Name</a>
                        <a class="dropdown-item sort-score"
                            href="#">Sort By Score</a>
                    </div>
                </div>
            </div>
            <div class="wrapper">
                <canvas id="polar-chart"></canvas>
            </div>
        </div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
        <script>
            $(document).ready(() => {
                const label = "@ejelome's The Big Five Aspects Scale results";
                const source = [{
                        id: 1,
                        name: "Agreeableness",
                        type: "trait",
                        score: 80,
                        color: "#f33",
                    },
                    {
                        id: 2,
                        name: "Compassion",
                        type: "aspect",
                        score: 66,
                        color: "#f99",
                    },
                    {
                        id: 3,
                        name: "Politeness",
                        type: "aspect",
                        score: 85,
                        color: "#fcc",
                    },
                    {
                        id: 4,
                        name: "Conscientiousness",
                        type: "trait",
                        score: 11,
                        color: "#3f3",
                    },
                    {
                        id: 5,
                        name: "Industriousness",
                        type: "trait",
                        score: 18,
                        color: "#9f9",
                    },
                    {
                        id: 6,
                        name: "Orderliness",
                        type: "trait",
                        score: 12,
                        color: "#cfc",
                    },
                    {
                        id: 7,
                        name: "Extraversion",
                        type: "trait",
                        score: 43,
                        color: "#33f",
                    },
                    {
                        id: 8,
                        name: "Enthusiasm",
                        type: "aspect",
                        score: 30,
                        color: "#00f",
                    },
                    {
                        id: 9,
                        name: "Assertiveness",
                        type: "aspect",
                        score: 58,
                        color: "#ccf",
                    },
                    {
                        id: 10,
                        name: "Neuroticism",
                        type: "trait",
                        score: 50,
                        color: "#333",
                    },
                    {
                        id: 11,
                        name: "Withdrawal",
                        type: "aspect",
                        score: 72,
                        color: "#999",
                    },
                    {
                        id: 12,
                        name: "Volatility",
                        type: "aspect",
                        score: 29,
                        color: "#ccc",
                    },
                    {
                        id: 13,
                        name: "Openness to Experience",
                        type: "trait",
                        score: 45,
                        color: "#fd3",
                    },
                    {
                        id: 14,
                        name: "Intellect",
                        type: "aspect",
                        score: 5,
                        color: "#fd9",
                    },
                    {
                        id: 15,
                        name: "Openness",
                        type: "aspect",
                        score: 90,
                        color: "#fdc",
                    },
                ];
                let cSource = source; // muchart copy
            
                const showChart = (obj) => {
                    const color = Chart.helpers.color;
                    const config = {
                        data: {
                            datasets: [{
                                data: Object.values(obj).map(o => o.score),
                                backgroundColor: Object.values(obj).map(o => color(o.color).alpha(0.5).rgbString()),
                                label: label,
                            }],
                            labels: Object.values(obj).map(o => [o.name].join(" ")),
                        },
                        options: {
                            tooltips: {
                                callbacks: {
                                    label: (item, data) => " " + data.labels[item.index]
                                },
                            },
                            events: [],
                            plugins: {
                                datalabels: {
                                    align: "end",
                                    color: "black",
                                    textShadowColor: "white",
                                    textShadowBlur: 9,
                                    formatter: (v, c) => c.chart.data.labels[c.dataIndex]
                                }
                            },
                            responsive: true,
                            legend: {
                                position: "left",
                            },
                            title: {
                                display: false,
                                text: label
                            },
                            scale: {
                                ticks: {
                                    min: 0,
                                    max: 100,
                                    beginAtZero: true
                                },
                                reverse: true
                            },
                            animation: {
                                animateRotate: true,
                                animateScale: true
                            }
                        }
                    };
            
                    const ctx = document.getElementById("polar-chart");
                    Chart.PolarArea(ctx, config);
                }
            
                /* Dropdowns: */
                $(".dropdown-item").click(function () {
                    $(this).parent().parent().find(".btn").text($(this).text());
                    $(this).parent().find(".dropdown-item").removeClass("active");
                    $(this).addClass("active");
                });
            
                /* Show dropdowns: */
                $(".show-all").click(() => {
                    cSource = source; // resets copy
                    showChart(cSource);
                });
            
                $(".show-traits").click(() => {
                    cSource = Object.values(source).filter(o => o.type === "trait");
                    showChart(cSource);
                });
            
                $(".show-aspects").click(() => {
                    cSource = Object.values(source).filter(o => o.type = "aspect");
                    showChart(cSource);
                });
            
                // Select "Show All" dropdown by default:
                $(".show-all").click();
            
                /* Sort dropdowns: */
                $(".sort-id").click(() => {
                    cSource = cSource.sort((a, b) => a.id - b.id);
                    showChart(cSource);
                });
            
                $(".sort-name").click(() => {
                    cSource = cSource.sort((a, b) => {
                        if (a.name < b.name) return -1;
                        if (a.name > b.name) return 1;
                        return 0;
                    });
                    showChart(cSource);
                });
            
                $(".sort-score").click(() => {
                    cSource = cSource.sort((a, b) => a.score - b.score);
                    showChart(cSource);
                });
            
                // Select "Sort By Score" dropdown by default:
                $(".sort-score").click();
                
                /* Go to page on click: */
                $(".nav-link").click(function () {
                    location.href = $(this).attr("href");
                });
            });
        </script>
    </body>
</html>
